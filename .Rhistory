library(tidyverse)
library(censusapi)
Sys.setenv(CENSUS_KEY="c8aa67e4086b4b5ce3a8717f59faa9a28f611dab")
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
)
View(bay_income_race_2019)
library(tidyverse)
library(censusapi)
Sys.setenv(CENSUS_KEY="c8aa67e4086b4b5ce3a8717f59faa9a28f611dab")
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E"))
View(bay_income_race_2019)
View(bay_income_race_2019)
knitr::opts_chunk$set(echo = TRUE)
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E") & -c(state, NAME
))
library(tidyverse)
library(censusapi)
Sys.setenv(CENSUS_KEY="c8aa67e4086b4b5ce3a8717f59faa9a28f611dab")
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E") & -c(state, NAME
))
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E") & -c(state, NAME
)) %>%
summarize_all(sum)
View(bay_income_race_2019)
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E") & -c(state, NAME
)) %>%
summarize_all(sum) %>%
pivot_longer(
everything()
names_to = "name"
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E") & -c(state, NAME
)) %>%
summarize_all(sum) %>%
pivot_longer(
everything(),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
)
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E") & -c(state, NAME
)) %>%
summarize_all(sum) %>%
pivot_longer(
everything(),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("","")
) %>%
separate(
label,
into = c(NA, NA, "income"),
sep = "!!"
)
\frac{0.2055+\sqrt{0.06288\dots }}{526.712}
acs_vars_2019_5yr <-
listCensusMetadata(
name = "2019/acs/acs5",
type = "variables"
)
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E") & -c(state, NAME
)) %>%
summarize_all(sum) %>%
pivot_longer(
everything(),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("","")
) %>%
separate(
label,
into = c(NA, NA, "income"),
sep = "!!"
)
bay_income_race_2019 <- getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = "group(B19001A)"
) %>%
select(ends_with("E") & -c(state, NAME
)) %>%
summarize_all(sum) %>%
pivot_longer(
everything(),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label),
by = c("","")
) %>%
separate(
label,
into = c(NA, NA, "income"),
sep = "!!"
) %>%
select(-name) %>%
filter(!is.na(income))
LETTERS
LETTERS[1:7]
bay_income_race_2019 <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = paste0("group(B19001",LETTERS[x],")")
) %>%
select(ends_with("E") & -c(state, NAME)) %>%
summarize_all(sum) %>%
pivot_longer(
everything(),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label)
) %>%
separate(
label,
into = c(NA, NA, "income"),
sep = "!!"
) %>%
select(-name) %>%
filter(!is.na(income)) %>%
mutate(
race = race_categories[x]
)
})
for(x in 1:7) {
full_dataset <-
rbind(full_dataset, temp)
}
race_categories <- c(
"White alone",
"Black or African American alone",
"American Indian and Alaska Native alone",
"Asian alone",
"Native Hawaiian and Other Pacific Islander alone",
"Some Other Race alone",
"Two or more Races"
)
bay_income_race_2019 <-
1:7 %>%
map_dfr(function(x){
getCensus(
name = "acs/acs5",
vintage = "2019",
region = "county:001,013,041,055,075,081,085,095,097",
regionin = "state:06",
vars = paste0("group(B19001",LETTERS[x],")")
) %>%
select(ends_with("E") & -c(state, NAME)) %>%
summarize_all(sum) %>%
pivot_longer(
everything(),
names_to = "name",
values_to = "estimate"
) %>%
left_join(
acs_vars_2019_5yr %>%
select(name, label)
) %>%
separate(
label,
into = c(NA, NA, "income"),
sep = "!!"
) %>%
select(-name) %>%
filter(!is.na(income)) %>%
mutate(
race = race_categories[x]
)
})
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(tigris)
library(mapview)
library(leaflet)
ca_counties <- counties("CA", cb = T, progress_bar = F)
nj_counties <- counties("NJ", cb = T, progress_bar = T)
View(nj_counties)
View(ca_counties)
class(ca_counties)
st_crs(ca_counties)
projection <- "+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"
ca_counties_transformed <-
ca_counties %>%
st_transform(4326) #%>%
# st_transform(26910) %>%
# st_transform(projection) %>%
# st_transform(st_crs(ca_counties))
st_crs(ca_counties)
st_crs(ca_counties_transformed)
st_transform(26910) #%>%
ca_counties_transformed <-
ca_counties %>%
st_transform(4326) %>%
st_transform(26910) #%>%
st_crs(ca_counties_transformed)
ca_counties_transformed <-
ca_counties %>%
st_transform(4326) %>%
st_transform(26910) %>%
st_transform(projection) #%>%
st_crs(ca_counties_transformed)
projection <- "+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"
ca_counties_transformed <-
ca_counties %>%
st_transform(4326) %>%
st_transform(26910) %>%
st_transform(projection) %>%
st_transform(st_crs(ca_counties))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(tigris)
library(mapview)
library(leaflet)
projection <- "+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"
m <- leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addMarkers(lng=174.768, lat=-36.852, popup="The birthplace of R")
m  # Print the map
---
title: "vivekvajipey_A2"
output: html_document
---
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(tigris)
library(mapview)
library(leaflet)
projection <- "+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"
ca_counties_transformed <-
ca_counties %>%
st_transform(4326) %>%
st_transform(26910) %>%
st_transform(projection) %>%
st_transform(st_crs(ca_counties))
ca_counties <- counties("CA", cb = T, progress_bar = F)
```{r}
```{r}
ca_counties <- counties("CA", cb = T, progress_bar = F)
nj_counties <- counties("NJ", cb = T, progress_bar = T)
nj_counties <- counties("NJ", cb = T, progress_bar = T)
projection <- "+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"
ca_counties_transformed <-
ca_counties %>%
st_transform(4326) %>%
st_transform(26910) %>%
st_transform(projection) %>%
st_transform(st_crs(ca_counties))
m <- leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addMarkers(lng=174.768, lat=-36.852, popup="The birthplace of R")
m  # Print the map
m <- leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addMarkers(lng=37.4275, lat=122.1697, popup="Stanfid")
m  # Print the map
m <- leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addMarkers(lng=122.1697, lat=37.4275, popup="Stanfid")
m  # Print the map
m <- leaflet() %>%
addTiles() %>%  # Add default OpenStreetMap map tiles
addMarkers(lng=-122.1697, lat=37.4275, popup="Stanfid")
m  # Print the map
ggplot(ca_counties) + geom_sf()
ggplot(nj_counties) + geom_sf()
```{r}
mapview(nj_counties)
ggplot(nj_counties) + geom_sf()
leaflet() %>%
addTiles() %>%
addPolygons(
data = ca_counties
) %>%
addMarkers(
data = ca_counties %>%
st_centroid()
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = nj_counties
) %>%
addMarkers(
data = nj_counties %>%
st_centroid()
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = nj_counties
) %>%
addMarkers(
data = nj_counties %>%
st_centroid(),
popup = "NJ!"
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = nj_counties
) %>%
addMarkers(
data = nj_counties %>%
st_centroid(),
popup = "NJ!",
hover = "NJ?"
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = nj_counties
) %>%
addMarkers(
data = nj_counties %>%
st_centroid(),
popup = "NJ!",
label = "NJ?"
)
leaflet() %>%
addTiles() %>%
addPolygons(
data = nj_counties
) %>%
addMarkers(
data = nj_counties %>%
st_centroid(),
popup = "NJ!",
label = "NJ?"
)
st_drop_geometry(nj_counties)
as.data.frame(nj_counties)
st_as_sf(nj_counties)
wwp_county_names <-
c(
"Middlesex",
"Mercer"
)
wwp_counties <-
counties("NJ", cb = T, progress_bar = F) %>%
filter(NAME %in% wwp_county_names)
ggplot(wwp_counties) + geom_sf()
leaflet() %>%
addTiles() %>%
addPolygons(
data = wwp_counties
) %>%
addMarkers(
data = wwp_counties %>%
st_centroid(),
popup = "NJ!",
label = "NJ?"
)
nj_cities = places("NJ", cb = T, progress_bar = F)
nj_cities = places("NJ", cb = T, progress_bar = F)
wwp_cities = nj_cities[wwp_counties, ]
nj_cities = places("NJ", cb = T, progress_bar = F)
wwp_cities = nj_cities[wwp_counties, ]
mapview(wwp_counties, alpha.regions = 0) + mapview(wwp_cities)
wwp_cities_within <-
nj_cities %>%
st_centroid() %>%
.[wwp_counties, ] %>%
st_drop_geometry() %>%
left_join(ca_cities %>% select(GEOID)) %>%
st_as_sf()
wwp_cities_within <-
nj_cities %>%
st_centroid() %>%
.[wwp_counties, ] %>%
st_drop_geometry() %>%
left_join(nj_cities %>% select(GEOID)) %>%
st_as_sf()
mapview(wwp_counties, alpha.regions = 0) + mapview(bay_cities_within, label = "NAME")
wwp_cities_within <-
nj_cities %>%
st_centroid() %>%
.[wwp_counties, ] %>%
st_drop_geometry() %>%
left_join(nj_cities %>% select(GEOID)) %>%
st_as_sf()
mapview(wwp_counties, alpha.regions = 0) + mapview(wwp_cities_within, label = "NAME")
leaflet() %>%
addTiles() %>%
addPolygons(
data = wwp_counties,
fill = F,
weight = 2,
label = ~NAME
) %>%
addPolygons(
data = wwp_cities %>%
filter(!GEOID %in% wwp_cities_within$GEOID),
color = "red",
label = ~NAME
) %>%
addPolygons(
data = wwp_cities_within,
color = "green",
label = ~NAME
)
wwp_cbgs <- block_groups("NJ", wwp_county_names[1:2], cb = T, progress_bar = F)
bay_cbgs_clip <- st_read("https://opendata.arcgis.com/datasets/037fc1597b5a4c6994b89c46a8fb4f06_0.geojson")
ggplot(bay_cbgs_clip)+geom_sf()
library(readxl)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(sf)
library(tigris)
library(leaflet)
library(censusapi)
library(mapview)
library(readxl)
library(readxl)
temp <- tempfile()
download.file("https://oehha.ca.gov/media/downloads/calenviroscreen/document/calenviroscreen40resultsdatadictionaryf2021.zip",destfile = temp)
ces4 <- read_excel(
unzip(
temp,
"calenviroscreen40resultsdatadictionary_F_2021.xlsx"
),
sheet = "CES4.0FINAL_results"
)
setwd("~/Documents/GitHub/vivekvajipey.github.io")
ces4 <- read_excel("calenviroscreen40resultsdatadictionary_F_2021.xlsx")
ces4 <- read_excel("calenviroscreen40resultsdatadictionary_F_2021.xlsx", sheet = "CES4.0FINAL_results")
view(ces4)
